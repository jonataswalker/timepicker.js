/*!
 * timepicker.js - v2.3.0
 * A lightweight, customizable, TimePicker. Zero dependencies.
 * https://github.com/jonataswalker/timepicker.js
 * Built: Mon Apr 09 2018 19:57:37 GMT-0300 (-03)
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.TimePicker=e()}(this,function(){"use strict";var t={hour:"data-hour",minute:"data-minute"},e={hour_list:"hour_list_id",minute_list:"minute_list_id"},n={namespace:"_jw-tpk",width:"260px",height:"140px",container_id:"-container-id",container_class:"-container",header_class:"-header",body_class:"-body",hour_class:"-hour",minute_class:"-minute",selected_class:"-selected",dragging_class:"-dragging",attr:t,ids:e};const i={open:"open",close:"close",change:"change",start_fade_in:"start-fade-in",end_fade_in:"end-fade-in",start_fade_out:"start-fade-out",end_fade_out:"end-fade-out"},o={lang:"en",theme:"dark"},s=/^(?:input|select|textarea|button|object)$/i,r=/^(?:a|area)$/i,a={en:{hour:"Hour",minute:"Minute"},pt:{hour:"Hora",minute:"Minuto"}},c=Object.freeze({namespace:"_jw-tpk",width:"260px",height:"140px",container_id:"-container-id",container_class:"-container",header_class:"-header",body_class:"-body",hour_class:"-hour",minute_class:"-minute",selected_class:"-selected",dragging_class:"-dragging",attr:t,ids:e,default:n}),l={container:"_jw-tpk-container",header:"_jw-tpk-header",body:"_jw-tpk-body",hour:"_jw-tpk-hour",minute:"_jw-tpk-minute",selected:"_jw-tpk-selected",dragging:"_jw-tpk-dragging"};function u(t,e){if(void 0===e&&(e="Assertion failed"),!t){if("undefined"!=typeof Error)throw new Error(e);throw e}}function d(t){return/^\d+$/.test(t)}function h(t,e,n,o){let s;void 0===n&&(n=300),void 0===o&&(o="in");let r,a=null,c=!1,l="in"===o?i.start_fade_in:i.start_fade_out,u="in"===o?i.end_fade_in:i.end_fade_out;const d=function(i){a||(t.publish(l,{target:e}),a=i),"in"===o?(s=+e.style.opacity+(i-a)/n,c=s>=1):(s=+e.style.opacity-(i-a)/n,c=s<=0),e.style.opacity=s,c?t.publish(u,{target:e}):r=window.requestAnimationFrame(d)};return r=window.requestAnimationFrame(d)}function p(t,e,n){if(Array.isArray(t))return void t.forEach(function(t){return p(t,e)});const i=Array.isArray(e)?e:e.split(/\s+/);let o=i.length;for(;o--;)m(t,i[o])||k(t,i[o],n)}function f(t,e,n){if(Array.isArray(t))return void t.forEach(function(t){return f(t,e,n)});const i=Array.isArray(e)?e:e.split(/\s+/);let o=i.length;for(;o--;)m(t,i[o])&&A(t,i[o],n)}function m(t,e){return t.classList?t.classList.contains(e):E(e).test(t.className)}function _(t,e,n){void 0===e&&(e=window.document);let i=/\./g,o=Array.prototype.slice,s=[];if(/^(#?[\w-]+|\.[\w-.]+)$/.test(t))switch(t[0]){case"#":s=[y(t.substr(1))];break;case".":s=o.call(e.getElementsByClassName(t.substr(1).replace(i," ")));break;default:s=o.call(e.getElementsByTagName(t))}else s=o.call(e.querySelectorAll(t));return n?s:s[0]}function g(t){let e;switch((n=t)===window&&n.document&&n.location?"window":n===document?"htmldocument":"string"==typeof n?"string":v(n)?"element":void 0){case"window":case"htmldocument":case"element":e=t;break;case"string":e=_("#"===t[0]||"."===t[0]?t:"#"+t);break;default:console.warn("Unknown type")}var n;return e}function y(t){return t="#"===t[0]?t.substr(1,t.length):t,document.getElementById(t)}function v(t){return"HTMLElement"in window?!!t&&t instanceof HTMLElement:!!t&&"object"==typeof t&&1===t.nodeType&&!!t.nodeName}function w(t,e){return[].slice.call(t.getElementsByTagName(e))}function b(t){const e=t.getBoundingClientRect(),n=document.documentElement;return{left:e.left+window.pageXOffset-n.clientLeft,top:e.top+window.pageYOffset-n.clientTop,width:t.offsetWidth,height:t.offsetHeight}}function E(t){return new RegExp("(^|\\s+) "+t+" (\\s+|$)")}function k(t,e,n){t.classList?t.classList.add(e):t.className=(t.className+" "+e).trim(),n&&d(n)&&window.setTimeout(function(){return A(t,e)},n)}function A(t,e,n){t.classList?t.classList.remove(e):t.className=t.className.replace(E(e)," ").trim(),n&&d(n)&&window.setTimeout(function(){return k(t,e)},n)}var x=function(t){this.Base=t};x.prototype.createPicker=function(){const t=this.Base.options,e=x.picker.indexOf(x.replace.hour_list),n=x.picker.indexOf(x.replace.minute_list),i=x.picker.indexOf(x.replace.hour_title),o=x.picker.indexOf(x.replace.minute_title);let s,r,u=[],d=[],h=0,p=6,f=0;for(;f<4;f++){for(r=h+p,u.push("<ol>");h<r;h++)u.push(["<li><a ",c.attr.hour,'="',h,'">',h,"</a></li>"].join(""));u.push("</ol>")}for(h=0,r=0,p=15,f=0;f<4;f++){for(r=h+p,d.push("<ol>");h<r;h+=5)s=h<10?s="0"+h:h,d.push(["<li><a ",c.attr.minute,'="',s,'">',s,"</a></li>"].join(""));d.push("</ol>")}x.picker[e]=u.join(""),x.picker[n]=d.join(""),x.picker[i]=a[t.lang].hour,x.picker[o]=a[t.lang].minute;const m=l.container+" "+c.namespace+"-"+t.theme,g=function(t,e){let n;if(Array.isArray(t)){if(n=document.createElement(t[0]),t[1].id&&(n.id=t[1].id),t[1].classname&&(n.className=t[1].classname),t[1].attr){let e=t[1].attr;if(Array.isArray(e)){let t=-1;for(;++t<e.length;)n.setAttribute(e[t].name,e[t].value)}else n.setAttribute(e.name,e.value)}}else n=document.createElement(t);n.innerHTML=e;let i=document.createDocumentFragment();for(;n.childNodes[0];)i.appendChild(n.childNodes[0]);return n.appendChild(i),n}(["div",{id:c.container_id,classname:m}],x.picker.join(""));g.style.zIndex=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=-1);const i=_("*",document,!0),o=i.length;for(;++n<o;)e=(t=parseInt(window.getComputedStyle(i[n]).zIndex,10))?Math.max(e,t):e;return e}()+10,g.style.visibility="hidden",document.body.appendChild(g);const y=b(g);return this.Base.container={size:{width:y.width,height:y.height},element:g,drag_handle:g.querySelector("."+l.header)},g.style.visibility="",g.style.display="none",g},x.replace={hour_list:"__hour-list__",minute_list:"__minute-list__",hour_title:"__hour-title__",minute_title:"__minute-title__"},x.picker=['<div class="'+l.header+'">','<div class="'+l.hour+'">',x.replace.hour_title,"</div>",'<div class="'+l.minute+'">',x.replace.minute_title,"</div>","</div>",'<div class="'+l.body+'">','<div id="'+c.ids.hour_list+'" class="'+l.hour+'">',x.replace.hour_list,"</div>",'<div id="'+c.ids.minute_list+'" class="'+l.minute+'">',x.replace.minute_list,"</div>","</div>"];var L=function(t){let e,n,i,o,s,r,a=t.container.element,c={},l=function(t){t.preventDefault&&t.preventDefault(),i=parseInt(a.style.left,10)||0,o=parseInt(a.style.top,10)||0,s=i+(t.clientX-e),r=o+(t.clientY-n),c.move.call(void 0,{target:a,x:s,y:r}),e=t.clientX,n=t.clientY},u=function(){document.removeEventListener("mousemove",l,!1),document.removeEventListener("mouseup",stop,!1),c.end.call(void 0,{target:a,x:s,y:r})};return t.container.drag_handle.addEventListener("mousedown",function(t){0===t.button&&(e=t.clientX,n=t.clientY,c.start.call({target:a}),document.addEventListener("mousemove",l,!1),document.addEventListener("mouseup",u,!1))},!1),{when:function(t){c.start=t.start,c.move=t.move,c.end=t.end}}},j=function(t){this.Base=t,this.container=t.container.element,this.closeWhen={hour:!1,minute:!1},this._ids=0,this.id_active=void 0,this.opened=!1,this.targets=[],this.collection={hours:[],minutes:[]},this.pubSub=function(){let t={},e=t.hasOwnProperty;return{subscribe:function(n,i){e.call(t,n)||(t[n]=[]);let o=t[n].push(i)-1;return{remove:function(){return delete t[n][o]}}},publish:function(n,i){e.call(t,n)&&t[n].forEach(function(t){return t(void 0!==i?i:{})})}}}(),this.request_ani_id=void 0};j.prototype.init=function(){this.setFocusListener(this.Base.target),this.setSelectListener()},j.prototype.show=function(t){const e=this.targets[t].element,n=b(e),o=this.Base.container.size,s=n.top+n.height+5,r={width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight};n.left+o.width>r.width?(this.container.style.left="",this.container.style.right="5px"):(this.container.style.right="",this.container.style.left=n.left+"px"),n.top+o.height>r.height?this.container.style.bottom="5px":this.container.style.top=s+"px",this.pubSub.subscribe(i.start_fade_in,function(t){t.target.style.opacity=0,t.target.style.display="block"}),this.request_ani_id=h(this.pubSub,this.container,400),this.Base.dispatchEvent(i.open,{element:e}),this.handleOpen(t)},j.prototype.show_=function(){var t=this;this.targets.forEach(function(e){return t.show(e.element._id)})},j.prototype.hide=function(t){this.opened=!1,this.pubSub.subscribe(i.start_fade_out,function(t){t.target.style.opacity=1,t.target.style.display="block"}),this.pubSub.subscribe(i.end_fade_out,function(t){t.target.style.display="none"}),this.request_ani_id=h(this.pubSub,this.container,800,"out"),this.Base.dispatchEvent(i.close,{element:this.targets[t].element})},j.prototype.hide_=function(){var t=this;this.targets.forEach(function(e){return t.hide(e.element._id)})},j.prototype.handleOpen=function(t){var e=this;const n=this,i=this.targets[t].hour,o=this.targets[t].minute;let s;f(this.collection.hours,l.selected),f(this.collection.minutes,l.selected),i&&o&&(this.collection.hours.forEach(function(t){(s=e.getHour(t))!==i||p(t,l.selected)}),this.collection.minutes.forEach(function(t){(s=e.getMinute(t))!==o||p(t,l.selected)})),document.addEventListener("mousedown",{handleEvent:function(e){if(n.container.contains(e.target))return;let i=!1;n.targets.forEach(function(t){t.element===e.target&&(i=!0)}),!i&&n.opened&&n.hide(t),n.targets[t].element!==e.target&&document.removeEventListener(e.type,this,!1)}},!1),this.opened=!0,this.id_active=t,this.closeWhen={hour:!1,minute:!1}},j.prototype.handleClose=function(t){this.closeWhen.hour&&this.closeWhen.minute&&this.hide(t)},j.prototype.getHour=function(t){return t.getAttribute(c.attr.hour)},j.prototype.getMinute=function(t){return t.getAttribute(c.attr.minute)},j.prototype.setSelectListener=function(){var t=this;const e=y(c.ids.hour_list),n=y(c.ids.minute_list),o=function(e){e.preventDefault();const n=t.targets[t.id_active];n.hour=t.getHour(e.target),t.Base.dispatchEvent(i.change,{element:n.element,hour:n.hour,minute:n.minute}),f(t.collection.hours,l.selected),p(e.target,l.selected),t.closeWhen.hour=!0,t.handleClose(t.id_active)},s=function(e){e.preventDefault();const n=t.targets[t.id_active];n.minute=t.getMinute(e.target),t.Base.dispatchEvent(i.change,{element:n.element,hour:n.hour,minute:n.minute}),f(t.collection.minutes,l.selected),p(e.target,l.selected),t.closeWhen.minute=!0,t.handleClose(t.id_active)};this.collection.hours=w(e,"a"),this.collection.minutes=w(n,"a"),this.collection.hours.forEach(function(t){t.addEventListener("click",o)}),this.collection.minutes.forEach(function(t){t.addEventListener("click",s)})},j.prototype.setFocusListener=function(t){var e=this;const n=function(t){t.preventDefault(),window.cancelAnimationFrame(e.request_ani_id),e.show(t.target._id)};let i,o=[];t=Array.isArray(t)?t:[t],Array.prototype.push.apply(o,t),o.forEach(function(t){if(!(i=g(t)))return;let o=e._ids++;i._id=o,e.targets[o]={element:i},s.test(i.nodeName)?i.addEventListener("focus",n,!0):r.test(i.nodeName)&&i.addEventListener("click",n,!0)})};var B=function(){this._events=this._events||{},this._onceEvents=this._onceEvents||{}};return B.prototype.on=function(t,e){if(!t||!e)return;let n=this._events[t]=this._events[t]||[];return-1===n.indexOf(e)&&n.push(e),this},B.prototype.once=function(t,e){if(!t||!e)return;return this.on(t,e),(this._onceEvents[t]=this._onceEvents[t]||{})[e]=!0,this},B.prototype.off=function(t,e){let n=this._events&&this._events[t];if(!n||!n.length)return;const i=n.indexOf(e);return-1!==i&&n.splice(i,1),this},B.prototype.dispatchEvent=function(t,e){void 0===e&&(e={});let n=this._events&&this._events[t];if(!n||!n.length)return;let i=0,o=n[i];const s=this._onceEvents&&this._onceEvents[t];for(;o;){let r=s&&s[o];r&&(this.off(t,o),delete s[o]),o.call(this,e),o=n[i+=r?0:1]}return this},function(t){function e(n,i){void 0===i&&(i={}),u(Array.isArray(n)||"string"==typeof n||v(n),"`target` should be Element, <Array>Element, String or <Array>String."),t.call(this),this.options=function(t,e){let n={};for(let e in t)n[e]=t[e];for(let t in e)n[t]=e[t];return n}(o,i),this.target=n,this.container={};const s=new x(this).createPicker(),r=new L(this);e.Internal=new j(this),e.Internal.init(),r.when({start:function(){p(s,c.namespace+c.dragging_class)},move:function(t){s.style.left=t.x+"px",s.style.top=t.y+"px"},end:function(t){f(s,c.namespace+c.dragging_class),t.y<0&&(s.style.top=0)}})}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.show=function(){e.Internal.show_()},e.prototype.hide=function(){e.Internal.hide_()},e.prototype.setTarget=function(t){u(Array.isArray(t)||"string"==typeof t||v(t),"`target` should be Element, <Array>Element, String or <Array>String."),this.target=t,e.Internal.setFocusListener(this.target)},e}(B)});
